<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet">
  <title>Smart Farming</title>
  <style>
    html {
      font-family: 'Open Sans', sans-serif;
      display: block;
      margin: 0px auto;
      color: #333333;
    }


    body {
      background-color: #E1E2E1;
    }

    h1 {
      margin: 50px auto 30px;
    }

    h2 {
      margin: 40px auto 25px;
    }

    .mainblok {
      border: 1px;
      text-align: center;
      background-color: #F5F5F6;
      margin: 5px 0px 0px 0px;
      padding: 0px 0px 0px 0px;
      -moz-border-radius-topleft: 10px;
      -webkit-border-top-left-radius: 10px;
      -moz-border-radius-topright: 10px;
      -webkit-border-top-right-radius: 10px;
    }

    .item {
      border: 1px;
      text-align: center;
      padding-top: 10px;
      padding-bottom: 10px;
      margin: 5px;
      background-color: #F5F5F6;
      -moz-border-radius-topleft: 10px;
      -webkit-border-top-left-radius: 10px;
      -moz-border-radius-bottomright: 10px;
      -webkit-border-top-right-radius: 10px;
      -moz-border-radius-bottomleft: 10px;
      -webkit-border-bottom-left-radius: 10px;
      -moz-border-radius-topright: 10px;
      -webkit-border-bottom-right-radius: 10px;
    }

    .phdr {
      background-color: #689f38;
      color: #ffffff;
      border: 1px solid #7cb342;
      padding: 10px;
      margin-left: auto;
      margin-right: auto;
      margin-top: auto;
      font-weight: bold;
      -moz-border-radius-topleft: 10px;
      -webkit-border-top-left-radius: 10px;
      -moz-border-radius-topright: 10px;
      -webkit-border-top-right-radius: 10px;
    }

    .header {
      color: #ffffff;
      background-image: linear-gradient(to right, #80b844, #5a9724);
      padding-left: 30px;
      margin-left: auto;
      margin-right: auto;
      margin-top: auto;
      font-weight: bold;
    }

    .side-by-side {
      display: inline-block;
      vertical-align: middle;
      position: relative;
    }

    .humidity-icon {
      background-color: #3498db;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      line-height: 36px;
    }

    .humidity-text {
      font-weight: 600;
      padding-left: 15px;
      font-size: 19px;
      width: 160px;
      text-align: left;
    }

    .humidity {
      font-weight: 300;
      font-size: 60px;
      color: #3498db;
    }

    .soil-icon {
      background-color: #4d3b3b;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      line-height: 36px;
    }

    .soil-text {
      font-weight: 600;
      padding-left: 15px;
      font-size: 19px;
      width: 160px;
      text-align: left;
    }

    .soil {
      font-weight: 300;
      font-size: 60px;
      color: #4d3b3b;
    }

    .temperature-icon {
      background-color: #ff0000;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      line-height: 40px;
    }

    .temperature-text {
      font-weight: 600;
      padding-left: 15px;
      font-size: 19px;
      width: 160px;
      text-align: left;
    }

    .temperature {
      font-weight: 300;
      font-size: 60px;
      color: #fd0000;
    }

    .ldr-icon {
      background-color: #f39c12;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      line-height: 40px;
    }

    .ldr-text {
      font-weight: 600;
      padding-left: 15px;
      font-size: 19px;
      width: 160px;
      text-align: left;
    }

    .ldr {
      font-weight: 300;
      font-size: 60px;
      color: #f39c12;
    }

    .superscript {
      font-size: 17px;
      font-weight: 600;
      position: absolute;
      right: -20px;
      top: 15px;
    }

    .data {
      padding: 10px;
    }

    /* The side navigation menu */
    .sidenav {
      height: 100%;
      width: 0;
      position: fixed;
      z-index: 1;
      top: 2;
      left: 0;
      background-color: #7cb342;
      overflow-x: hidden;
      padding-top: 60px;
      transition: 0.5s;
    }

    /* The navigation menu links */
    .sidenav a {
      padding: auto;
      text-decoration: none;
      font-size: 25px;
      color: #272727;
      display: block;
      transition: 0.3s;
    }

    /* When you mouse over the navigation links, change their color */
    .sidenav a:hover {
      color: #689f38;
    }

    /* Position and style the close button (top right corner) */
    .sidenav .closebtn {
      position: absolute;
      top: 0;
      right: 25px;
      font-size: 36px;
      margin-left: 50px;
    }

    @media screen and (max-height: 450px) {
      .sidenav {
        padding-top: 15px;
      }

      .sidenav a {
        font-size: 18px;
      }
    }

    .on {
      background-image: url(ic_poweron.png) !important;
    }

    .off {
      background-image: url(ic_poweroff.png);
    }
  </style>
</head>

<body>
  <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-functions.js"></script>
  <script>
    function openNav() {
      document.getElementById("mySidenav").style.width = "250px";
      document.getElementById("main").style.marginLeft = "250px";
    }
    function closeNav() {
      document.getElementById("mySidenav").style.width = "0";
      document.getElementById("main").style.marginLeft = "0";
    }
    function switchLamp() {
      let lampID = document.getElementById('lamp');
      if (sttLamp == true) {
        lampID.classList.remove("off");
        lampID.classList.add("on");
        sttLamp = false;
      } else {
        lampID.classList.remove("on");
        lampID.classList.add("off");
        sttLamp = true;
      }
    }
    function switchPump() {
      let pumpID = document.getElementById('pump');
      if (sttPump == true) {
        pumpID.classList.remove("off");
        pumpID.classList.add("on");
        sttPump = false;
      } else {
        pumpID.classList.remove("on");
        pumpID.classList.add("off");
        sttPump = true;
      }
    }

  </script>
  <script>
    var temp, humid, ldr, soil, pump, lamp;
    var firebaseConfig = {
      apiKey: "AIzaSyD2mpwmE6rM0Ea0_fxnU47krkWRQP5E8gk",
      authDomain: "esp8266-weather-reporter.firebaseapp.com",
      databaseURL: "https://esp8266-weather-reporter.firebaseio.com",
      projectId: "esp8266-weather-reporter",
      storageBucket: "esp8266-weather-reporter.appspot.com",
      messagingSenderId: "237893255966",
      appId: "1:237893255966:web:7ededdbbce1b3e449d3f0f"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    var database = firebase.database();
    var db_DHT = firebase.database().ref('DHTtest');
    var db_Control = firebase.database().ref('Control');
    let sttLamp, sttPump;
    function toggleLamp() {
      sttLamp = !sttLamp;
      firebase.database().ref('Control').update({
        Relay2: sttLamp == true ? 1 : 0
      });
    }

    function togglePump() {
      sttPump = !sttPump;
      firebase.database().ref('Control').update({
        Relay1: sttPump == true ? 1 : 0
      });
    }
    var startListening = function () {
      db_DHT.on('value', function (snapshot) {
        temp = snapshot.child("Temperature").val();
        humid = snapshot.child("Humidity").val();
        ldr = snapshot.child("LDR").val();
        soil = snapshot.child("Soil").val();
        console.log('Temp = ' + temp + ', Humidity = ' + humid + ', LDR = ' + ldr + ', Soil = ' + soil);
        document.getElementById("temp").innerHTML = temp;
        document.getElementById("humid").innerHTML = humid;
        document.getElementById("ldr").innerHTML = ldr;
        document.getElementById("soil").innerHTML = soil;
      })
      db_Control.on('value', function (snapshot) {
        pump = snapshot.child("Relay1").val();
        lamp = snapshot.child("Relay2").val();
        sttPump = pump == 1 ? true : false;
        sttLamp = lamp == 1 ? true : false;
        switchLamp();
        switchPump();
      });
    }
    startListening();

  </script>

  <div id="mySidenav" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <a href="#">
      <div class="item">Dashboard</div>
    </a>
    <a href="#">
      <div class="item">Chart</div>
    </a>
    <a href="#">
      <div class="item">Setting</div>
    </a>
    <a href="#">
      <div class="item">About Us</div>
    </a>
  </div>

  <div id="main">
    <h1 class="header"><br><span style="font-size:30px;cursor:pointer;text-align: left;"
        onclick="openNav()">&#9776;</span> Smart
      Farming<br><br></h1>

    <!-- Use any element to open the sidenav -->
    <div class="mainblok">
      <h2 class="phdr">Sensor</h2>

      <table style="width:100%">
        <tr>
          <th>
            <div class="data">
              <div class="side-by-side">
                <img src="ic_temp.png" width="45px" height="45px">
              </div>
              <div class="side-by-side temperature-text">Temperature</div>
              <div class="side-by-side temperature">
                <span id="temp">00</span>
                <span class="superscript">Â°C</span>
              </div>
            </div>
          </th>

          <th>
            <div class="data">
              <div class="side-by-side">
                <img src="ic_ldr.png" width="45px" height="45px">
              </div>
              <div class="side-by-side ldr-text">Light</div>
              <div class="side-by-side ldr">
                <span id="ldr">00</span>
                <span class="superscript">%</span>
              </div>
            </div>
          </th>
        </tr>

        <tr>
          <th>
            <div class="data">
              <div class="side-by-side">
                <img src="ic_humidity.png" width="45px" height="45px">
              </div>
              <div class="side-by-side humidity-text">Humidity</div>
              <div class="side-by-side humidity">
                <span id="humid">00</span>
                <span class="superscript">%</span>
              </div>
            </div>
          </th>

          <th>
            <div class="data">
              <div class="side-by-side">
                <img src="ic_soil.png" width="45px" height="45px">
              </div>
              <div class="side-by-side soil-text">Soil</div>
              <div class="side-by-side soil">
                <span id="soil">00</span>
                <span class="superscript">%</span>
              </div>
            </div>
          </th>
        </tr>
      </table>
    </div>
    <br>
    <div class="mainblok">
      <h2 class="phdr" id="id1">Control</h2>
      <table style="width:100%">
        <tr>
          <th>
            <input type="image" id="pump" class="off" width="96px" height="96px" value=""
              onclick="togglePump()"></input>
          </th>
          <th>
            <input type="image" id="lamp" class="off" width="96px" height="96px" value=""
              onclick="toggleLamp()"></input>
          </th>
        </tr>
        <tr>
          <th>
            Pump
          </th>
          <th>
            Lamp
          </th>
        </tr>
      </table><br>
    </div>
  </div>
</body>

</html>